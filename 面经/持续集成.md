工厂里的装配线以快速、自动化、可重复的方式从原材料生产出消费品。同样，软件交付管道以快速、自动化和可重复的方式从源代码生成发布版本。如何完成这项工作的总体设计称为“持续交付”（CD）。启动装配线的过程称为“持续集成”（CI）。确保质量的过程称为“持续测试”，将最终产品提供给用户的过程称为“持续部署”。一些专家让这一切简单、顺畅、高效地运行，这些人被称为  *运维开发(DevOps)* 践行者。

## “持续”是什么意思？

“持续”用于描述遵循我在此提到的许多不同流程实践。这并不意味着“一直在运行”，而是“随时可运行”。在软件开发领域，它还包括几个核心概念/最佳实践。这些是：

* **频繁发布** ：持续实践背后的目标是能够频繁地交付高质量的软件。此处的交付频率是可变的，可由开发团队或公司定义。对于某些产品，一季度、一个月、一周或一天交付一次可能已经足够频繁了。对于另一些来说，一天可能需要多次交付也是可行的。所谓持续也有“偶尔、按需”的方面。最终目标是相同的：在可重复、可靠的过程中为最终用户提供高质量的软件更新。通常，这可以通过很少甚至无需用户的交互或掌握的知识来完成（想想设备更新）。
* **自动化流程** ：实现此频率的关键是用自动化流程来处理软件生产中的方方面面。这包括构建、测试、分析、版本控制，以及在某些情况下的部署。
* **可重复** ：如果我们使用的自动化流程在给定相同输入的情况下始终具有相同的行为，则这个过程应该是可重复的。也就是说，如果我们把某个历史版本的代码作为输入，我们应该得到对应相同的可交付产出。这也假设我们有相同版本的外部依赖项（即我们不创建该版本代码使用的其它交付物）。理想情况下，这也意味着可以对管道中的流程进行版本控制和重建（请参阅稍后的 DevOps 讨论）。
* **快速迭代** ：“快速”在这里是个相对术语，但无论软件更新/发布的频率如何，预期的持续过程都会以高效的方式将源代码转换为交付物。自动化负责大部分工作，但自动化处理的过程可能仍然很慢。例如，对于每天需要多次发布候选版更新的产品来说，一轮  *集成测试(integrated testing)* 下来耗时就要大半天可能就太慢了。

### 什么是持续交付管道？

将源代码转换为可发布产品的多个不同的  *任务(task)* 和  *作业(job)* 通常串联成一个软件“管道”，一个自动流程成功完成后会启动管道中的下一个流程。这些管道有许多不同的叫法，例如持续交付管道、部署管道和软件开发管道。大体上讲，程序管理者在管道执行时管理管道各部分的定义、运行、监控和报告。

## 什么是持续集成？

持续集成（CI）是在源代码变更后自动检测、拉取、构建和（在大多数情况下）进行单元测试的过程。持续集成是启动管道的环节（尽管某些预验证 —— 通常称为 *上线前检查(pre-flight checks)* —— 有时会被归在持续集成之前）。持续集成的目的，快速迭代，保持高质量，避免不必要的成本投入。

简单说，持续集成就是指频繁自动将代码集成到主干和生产环境

优点：

1. 快速定位错误，测试环节可以及时暴露问题；
2. 避免大幅度偏离主干，借助统一的代码库；
3. 减少不必要的成本投入，可以自动化解决的重复乏味的事情，没必要浪费人力和时间；

### 持续集成是如何工作的？

持续集成的基本思想是让一个自动化过程监测一个或多个源代码仓库是否有变更。当变更被推送到仓库时，它会监测到更改、下载副本、构建并运行任何相关的单元测试。

### 持续集成如何检测变更？

* **轮询** ：监测程序反复询问代码管理系统，“代码仓库里有什么我感兴趣的新东西吗？”当代码管理系统有新的变更时，监测程序会“唤醒”并完成其工作以获取新代码并构建/测试它。
* **定期** ：监测程序配置为定期启动构建，无论源码是否有变更。理想情况下，如果没有变更，则不会构建任何新内容，因此这不会增加额外的成本。
* **推送** ：这与用于代码管理系统检查的监测程序相反。在这种情况下，代码管理系统被配置为提交变更到仓库时将“推送”一个通知到监测程序。最常见的是，这可以以 webhook 的形式完成 —— 在新代码被推送时一个  *挂勾(hook)* 的程序通过互联网向监测程序发送通知。为此，监测程序必须具有可以通过网络接收 webhook 信息的开放端口。

## 什么是持续测试？

持续测试是指在代码通过持续交付管道时运行扩展范围的自动化测试的实践。单元测试通常与构建过程集成，作为持续集成阶段的一部分，并专注于和其它与之交互的代码隔离的测试。

除此之外，可以有或者应该有各种形式的测试。这些可包括：

* **集成测试** 验证组件和服务组合在一起是否正常。
* **功能测试** 验证产品中执行功能的结果是否符合预期。
* **验收测试** 根据可接受的标准验证产品的某些特征。如性能、可伸缩性、抗压能力和容量。

所有这些可能不存在于自动化的管道中，并且一些不同类型的测试分类界限也不是很清晰。但是，在交付管道中持续测试的目标始终是相同的：通过持续的测试级别证明代码的质量可以在正在进行的发布中使用。在持续集成快速的原则基础上，第二个目标是快速发现问题并提醒开发团队。这通常被称为快速失败。

## 什么是持续交付？

持续交付（CD）通常是指整个流程链（管道），它自动监测源代码变更并通过构建、测试、打包和相关操作运行它们以生成可部署的版本，基本上没有任何人为干预。

持续交付在软件开发过程中的目标是自动化、效率、可靠性、可重复性和质量保障（通过持续测试）。

持续交付包含持续集成（自动检测源代码变更、执行构建过程、运行单元测试以验证变更），持续测试（对代码运行各种测试以保障代码质量），和（可选）持续部署（通过管道发布版本自动提供给用户）。

## 什么是持续部署？

持续部署（CD）是指能够自动提供持续交付管道中发布版本给最终用户使用的想法。根据用户的安装方式，可能是在云环境中自动部署、app 升级（如手机上的应用程序）、更新网站或只更新可用版本列表。

这里的一个重点是，仅仅因为可以进行持续部署并不意味着始终部署来自管道的每组可交付成果。它实际上指，通过管道每套可交付成果都被证明是“可部署的”。这在很大程度上是由持续测试的连续级别完成的（参见本文中的持续测试部分）。

管道构建的发布成果是否被部署可以通过人工决策，或利用在完全部署之前“试用”发布的各种方法来进行控制。

## 什么是DevOps？

*[运维开发](https://link.zhihu.com/?target=https%3A//opensource.com/resources/devops)(DevOps)* 是关于如何使开发和运维团队更容易合作开发和发布软件的一系列想法和推荐的实践。从历史上看，开发团队研发了产品，但没有像客户那样以常规、可重复的方式安装/部署它们。在整个周期中，这组安装/部署任务（以及其它支持任务）留给运维团队负责。这经常导致很多混乱和问题，因为运维团队在后期才开始介入，并且必须在短时间内完成他们的工作。同样，开发团队经常处于不利地位 —— 因为他们没有充分测试产品的安装/部署功能，他们可能会对该过程中出现的问题感到惊讶。

这往往导致开发和运维团队之间严重脱节和缺乏合作。DevOps 理念主张是贯穿整个开发周期的开发和运维综合协作的工作方式，就像持续交付那样。

## 持续交付如何与DevOps打交道？

持续交付管道是几个 DevOps 理念的实现。产品开发的后期阶段（如打包和部署）始终可以在管道的每次运行中完成，而不是等待产品开发周期中的特定时间。同样，从开发到部署过程中，开发和运维都可以清楚地看到事情何时起作用，何时不起作用。要使持续交付管道循环成功，不仅要通过与开发相关的流程，还要通过与运维相关的流程。

说得更远一些，DevOps 建议实现管道的基础架构也会被视为代码。也就是说，它应该自动配置、可跟踪、易于修改，并在管道发生变化时触发新一轮运行。这可以通过将管道实现为代码来完成。

## Jenkins

### Jenkins是什么？

Jenkins 是一个开源自动化服务器，是基于 Java 开发的一种持续集成工具，用于监控持续重复的工作，实现软件开发过程中非人为部分的自动化。

### 为什么使用Jenkins？

Jenkins是一种使用Java编程语言编写的开源持续集成软件工具，用于实时测试和报告较大代码库中的孤立更改。 Jenkins软件使开发人员能够快速找到并解决代码库中的缺陷，并自动进行构建测试。

### 如何在Jenkins中计划构建？

在Jenkins中，在工作配置下，我们可以定义各种构建触发器，如定期触发、检测到项目中源代码更改时触发、通过url请求触发、webhook回调触发等

比如说定期构建，只需找到“构建触发器”部分，然后选中“定期构建”复选框即可。 使用定期构建，您可以按星期几或星期几以及执行构建的时间安排构建定义。 “时间表”文本框的格式如下： MINUTE（0-59），HOUR （0-23），DAY（1-31），MONTH（1-12），WEEK （0-7）

### 为什么在Jenkins中使用管道？

pipeline是Jenkins里的一套强大的自动化工具，它是基于Groovy语言来实现的，支持简单的持续集成到全面的持续交付管道的用例。通过编写pipeline脚本用户可以灵活的定义持续集成或者持续交付的流程。比如可以定义代码的测试环境、从哪个仓库去拉取代码、如何构建并运行测试用例、如何将测试结果推送给用户等

###Jenkinsfile是什么？

Jenkinsfile是一个文本文件，其中包含Jenkins Pipeline的定义，并已签入源代码管理。 创建Jenkinsfile（已检入源代码管理）可带来许多直接好处： 管道上的代码审查/迭代；管道的审计跟踪；管道的唯一事实来源，可以由项目的多个成员查看和编辑。

### Jenkins中的Blue Ocean是什么？

Blue Ocean是一个重新思考Jenkins的用户体验的项目，它通过尽可能少的点击显示对开发团队重要的信息，同时仍然忠于Jenkins核心的可扩展性，从而对软件开发过程进行建模和展示。

### 如何在Jenkins中创建和复制文件？

创建备份，需要做的就是定期备份JENKINS_HOME目录。 这包含所有构建作业配置，从属节点配置以及构建历史记录。 要创建Jenkins设置的备份，只需复制此目录。
